import{u as b,R as p,j as e,G as a,B as n,L as x,M as f,d as i}from"./index-BUOXtG_d.js";import{u as h}from"./dexie-react-hooks-BFzjHO4r.js";import{T as k}from"./Title-LiqCpP7-.js";import{S as c}from"./Stack-CQdDs9Ke.js";import{T as m}from"./Text-AuOpa7JD.js";import{C as g}from"./Card-Da5QNOEj.js";function T(){const t=h(()=>i.lorebooks.toArray()),[d,s]=b(),[r,u]=p.useState(null),j=o=>{u(o),s.open()};return e.jsxs(p.Fragment,{children:[e.jsxs(a,{justify:"space-between",align:"end",mb:"md",children:[e.jsx(k,{order:2,children:"Lorebooks"}),e.jsx(n,{component:x,to:"/lorebook/new/",children:"New Lorebook"})]}),e.jsxs(c,{gap:"xs",children:[t?.map(o=>e.jsx(C,{lorebook:o,onDelete:()=>j(o.id)},o.id)),(!t||t.length===0)&&e.jsx(m,{c:"dimmed",children:"No lorebooks yet. Create one to get started."})]}),e.jsxs(f,{opened:d,onClose:s.close,title:"Delete Lorebook",children:["Are you sure you want to delete this lorebook?",e.jsxs(a,{mt:"md",justify:"flex-end",children:[e.jsx(n,{variant:"default",onClick:s.close,children:"Cancel"}),e.jsx(n,{color:"red",onClick:async()=>{r&&(await i.lorebooks.delete(r),await Promise.all([i.personas.toCollection().modify(o=>{o.lorebookIds=(o.lorebookIds||[]).filter(l=>l!==r)}),i.characters.toCollection().modify(o=>{o.lorebookIds=(o.lorebookIds||[]).filter(l=>l!==r)}),i.chats.toCollection().modify(o=>{o.lorebookIds=(o.lorebookIds||[]).filter(l=>l!==r)})])),s.close()},children:"Delete"})]})]})]})}function C({lorebook:t,onDelete:d}){return e.jsx(g,{radius:"md",p:"md",withBorder:!0,style:{backdropFilter:"saturate(180%) blur(20px)",backgroundColor:"rgba(0, 0, 0, 0.3)"},children:e.jsxs(a,{justify:"space-between",align:"start",gap:"md",children:[e.jsxs(c,{gap:4,flex:1,children:[e.jsx(m,{fw:600,children:t.name}),e.jsx(m,{size:"sm",c:"dimmed",children:t.description||"No description"})]}),e.jsxs(c,{gap:"xs",children:[e.jsx(n,{onClick:s=>{s.stopPropagation()},component:x,to:`/lorebook/${t.id}`,size:"compact-xs",children:"Edit"}),e.jsx(n,{size:"compact-xs",color:"red",onClick:s=>{s.preventDefault(),s.stopPropagation(),d()},children:"Delete"})]})]})})}export{T as component};
