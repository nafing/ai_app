import{u as f,R as d,j as e,G as i,B as o,L as m,d as r,M as w,T as p}from"./index-C0zzDxg3.js";import{u as C}from"./dexie-react-hooks-C6CB1zr1.js";import{T as g}from"./Title-CS8W2Y1W.js";import{S as l}from"./Stack-Dq9b-9EA.js";import{C as v}from"./Card-DjzwjL3m.js";import{A}from"./Avatar-Bk6D0BYS.js";function T(){const s=C(()=>r.personas.toArray()),[c,n]=f(),[a,u]=d.useState(null),x=t=>{u(t),n.open()};return e.jsxs(d.Fragment,{children:[e.jsxs(i,{justify:"space-between",align:"end",mb:"md",children:[e.jsx(g,{order:2,children:"Personas"}),e.jsx(o,{component:m,to:"/persona/new/",children:"New Persona"})]}),e.jsx(l,{gap:"xs",children:s?.map(t=>e.jsx(y,{p:t,onDelete:()=>x(t.id),setAsActive:()=>{r.transaction("rw",r.personas,async()=>{const j=await r.personas.toArray();for(const h of j)await r.personas.update(h.id,{isActive:!1});await r.personas.update(t.id,{isActive:!0})})}},t.id))}),e.jsxs(w,{opened:c,onClose:n.close,title:"Delete Persona",children:["Are you sure you want to delete this persona?",e.jsxs(i,{mt:"md",justify:"flex-end",children:[e.jsx(o,{variant:"default",onClick:n.close,children:"Cancel"}),e.jsx(o,{color:"red",onClick:async()=>{a&&await r.personas.delete(a),n.close()},children:"Delete"})]})]})]})}function y({p:s,onDelete:c,setAsActive:n}){return e.jsx(v,{radius:"md",p:"md",withBorder:!0,style:{backdropFilter:"saturate(180%) blur(20px)",backgroundColor:`rgba(0, 0, 0, ${s.isActive?.85:.25})`},onClick:()=>n(),children:e.jsxs(i,{justify:"space-between",children:[e.jsxs(i,{wrap:"nowrap",children:[e.jsx(A,{radius:"xl",src:s.avatar,alt:s.name,size:"lg"}),e.jsxs(l,{gap:4,children:[e.jsx(p,{fw:600,children:s.name}),e.jsxs(p,{size:"sm",c:"dimmed",children:[s.inChatName," (",s.isActive?"Active":"Inactive",")"]})]})]}),e.jsxs(l,{gap:"xs",children:[e.jsx(o,{onClick:a=>{a.stopPropagation()},component:m,to:`/persona/${s.id}`,size:"compact-xs",children:"Edit"}),e.jsx(o,{size:"compact-xs",color:"red",onClick:a=>{a.preventDefault(),a.stopPropagation(),c()},children:"Delete"})]})]})})}export{T as component};
