import{u as f,R as d,j as e,G as i,B as n,L as m,d as a,M as w}from"./index-BrAtYWpN.js";import{u as C}from"./dexie-react-hooks-CsjlevEe.js";import{T as g}from"./Title-VPPFuY2B.js";import{S as l}from"./Stack-MIQAC9Ot.js";import{C as v}from"./Card-D_uNUUZV.js";import{A}from"./Avatar-CJ7XAVRD.js";import{T as p}from"./Text-BYB51XnE.js";function B(){const s=C(()=>a.personas.toArray()),[c,o]=f(),[r,u]=d.useState(null),x=t=>{u(t),o.open()};return e.jsxs(d.Fragment,{children:[e.jsxs(i,{justify:"space-between",align:"end",mb:"md",children:[e.jsx(g,{order:2,children:"Personas"}),e.jsx(n,{component:m,to:"/persona/new/",children:"New Persona"})]}),e.jsx(l,{gap:"xs",children:s?.map(t=>e.jsx(y,{p:t,onDelete:()=>x(t.id),setAsActive:()=>{a.transaction("rw",a.personas,async()=>{const j=await a.personas.toArray();for(const h of j)await a.personas.update(h.id,{isActive:!1});await a.personas.update(t.id,{isActive:!0})})}},t.id))}),e.jsxs(w,{opened:c,onClose:o.close,title:"Delete Persona",children:["Are you sure you want to delete this persona?",e.jsxs(i,{mt:"md",justify:"flex-end",children:[e.jsx(n,{variant:"default",onClick:o.close,children:"Cancel"}),e.jsx(n,{color:"red",onClick:async()=>{r&&await a.personas.delete(r),o.close()},children:"Delete"})]})]})]})}function y({p:s,onDelete:c,setAsActive:o}){return e.jsx(v,{radius:"md",p:"md",withBorder:!0,style:{backdropFilter:"saturate(180%) blur(20px)",backgroundColor:`rgba(0, 0, 0, ${s.isActive?.85:.25})`},onClick:()=>o(),children:e.jsxs(i,{justify:"space-between",children:[e.jsxs(i,{wrap:"nowrap",children:[e.jsx(A,{radius:"xl",src:s.avatar,alt:s.name,size:"lg"}),e.jsxs(l,{gap:4,children:[e.jsx(p,{fw:600,children:s.name}),e.jsxs(p,{size:"sm",c:"dimmed",children:[s.inChatName," (",s.isActive?"Active":"Inactive",")"]})]})]}),e.jsxs(l,{gap:"xs",children:[e.jsx(n,{onClick:r=>{r.stopPropagation()},component:m,to:`/persona/${s.id}`,size:"compact-xs",children:"Edit"}),e.jsx(n,{size:"compact-xs",color:"red",onClick:r=>{r.preventDefault(),r.stopPropagation(),c()},children:"Delete"})]})]})})}export{B as component};
