import{r as a,ax as Fe}from"./index-PeDk-rhE.js";function he(t){if(!/^[0-9a-zA-Z-]+$/.test(t))throw new Error(`[@mantine/use-form] Form name "${t}" is invalid, it should contain only letters, numbers and dashes`)}const me=typeof window<"u"?a.useLayoutEffect:a.useEffect;function j(t,e){me(()=>{if(t)return window.addEventListener(t,e),()=>window.removeEventListener(t,e)},[t])}function je(t,e){t&&he(t),j(`mantine-form:${t}:set-field-value`,r=>e.setFieldValue(r.detail.path,r.detail.value)),j(`mantine-form:${t}:set-values`,r=>e.setValues(r.detail)),j(`mantine-form:${t}:set-initial-values`,r=>e.setInitialValues(r.detail)),j(`mantine-form:${t}:set-errors`,r=>e.setErrors(r.detail)),j(`mantine-form:${t}:set-field-error`,r=>e.setFieldError(r.detail.path,r.detail.error)),j(`mantine-form:${t}:clear-field-error`,r=>e.clearFieldError(r.detail)),j(`mantine-form:${t}:clear-errors`,e.clearErrors),j(`mantine-form:${t}:reset`,e.reset),j(`mantine-form:${t}:validate`,e.validate),j(`mantine-form:${t}:validate-field`,r=>e.validateField(r.detail)),j(`mantine-form:${t}:reorder-list-item`,r=>e.reorderListItem(r.detail.path,r.detail.payload)),j(`mantine-form:${t}:remove-list-item`,r=>e.removeListItem(r.detail.path,r.detail.index)),j(`mantine-form:${t}:insert-list-item`,r=>e.insertListItem(r.detail.path,r.detail.item,r.detail.index)),j(`mantine-form:${t}:set-dirty`,r=>e.setDirty(r.detail)),j(`mantine-form:${t}:set-touched`,r=>e.setTouched(r.detail)),j(`mantine-form:${t}:reset-dirty`,r=>e.resetDirty(r.detail)),j(`mantine-form:${t}:reset-touched`,e.resetTouched)}function Ce(t){return e=>{if(!e)t(e);else if(typeof e=="function")t(e);else if(typeof e=="object"&&"nativeEvent"in e){const{currentTarget:r}=e;r instanceof HTMLInputElement?r.type==="checkbox"?t(r.checked):t(r.value):(r instanceof HTMLTextAreaElement||r instanceof HTMLSelectElement)&&t(r.value)}else t(e)}}function X(t){return t===null||typeof t!="object"?{}:Object.keys(t).reduce((e,r)=>{const s=t[r];return s!=null&&s!==!1&&(e[r]=s),e},{})}function ke(t){const[e,r]=a.useState(X(t)),s=a.useRef(e),n=a.useCallback(u=>{r(f=>{const V=X(typeof u=="function"?u(f):u);return s.current=V,V})},[]),o=a.useCallback(()=>n({}),[]),c=a.useCallback(u=>{s.current[u]!==void 0&&n(f=>{const V={...f};return delete V[u],V})},[e]),i=a.useCallback((u,f)=>{f==null||f===!1?c(u):s.current[u]!==f&&n(V=>({...V,[u]:f}))},[e]);return{errorsState:e,setErrors:n,clearErrors:o,setFieldError:i,clearFieldError:c}}function Z(t,e){if(e===null||typeof e!="object")return{};const r={...e};return Object.keys(e).forEach(s=>{s.includes(`${String(t)}.`)&&delete r[s]}),r}function ee(t,e){const r=t.substring(e.length+1).split(".")[0];return parseInt(r,10)}function te(t,e,r,s){if(e===void 0)return r;const n=`${String(t)}`;let o=r;s===-1&&(o=Z(`${n}.${e}`,o));const c={...o},i=new Set;return Object.entries(o).filter(([u])=>{if(!u.startsWith(`${n}.`))return!1;const f=ee(u,n);return Number.isNaN(f)?!1:f>=e}).forEach(([u,f])=>{const V=ee(u,n),h=u.replace(`${n}.${V}`,`${n}.${V+s}`);c[h]=f,i.add(h),i.has(u)||delete c[u]}),c}function De(t,{from:e,to:r},s){const n=`${t}.${e}`,o=`${t}.${r}`,c={...s},i=new Set;return Object.keys(s).forEach(u=>{if(i.has(u))return;let f,V;if(u.startsWith(n)?(f=u,V=u.replace(n,o)):u.startsWith(o)&&(f=u.replace(o,n),V=u),f&&V){const h=c[f],m=c[V];m===void 0?delete c[f]:c[f]=m,h===void 0?delete c[V]:c[V]=h,i.add(f),i.add(V)}}),c}function re(t,e,r){typeof r.value=="object"&&(r.value=A(r.value)),!r.enumerable||r.get||r.set||!r.configurable||!r.writable||e==="__proto__"?Object.defineProperty(t,e,r):t[e]=r.value}function A(t){if(typeof t!="object")return t;var e=0,r,s,n,o=Object.prototype.toString.call(t);if(o==="[object Object]"?n=Object.create(t.__proto__||null):o==="[object Array]"?n=Array(t.length):o==="[object Set]"?(n=new Set,t.forEach(function(c){n.add(A(c))})):o==="[object Map]"?(n=new Map,t.forEach(function(c,i){n.set(A(i),A(c))})):o==="[object Date]"?n=new Date(+t):o==="[object RegExp]"?n=new RegExp(t.source,t.flags):o==="[object DataView]"?n=new t.constructor(A(t.buffer)):o==="[object ArrayBuffer]"?n=t.slice(0):o.slice(-6)==="Array]"&&(n=new t.constructor(t)),n){for(s=Object.getOwnPropertySymbols(t);e<s.length;e++)re(n,s[e],Object.getOwnPropertyDescriptor(t,s[e]));for(e=0,s=Object.getOwnPropertyNames(t);e<s.length;e++)Object.hasOwnProperty.call(n,r=s[e])&&n[r]===t[r]||re(n,r,Object.getOwnPropertyDescriptor(t,r))}return n||t}function ie(t){return typeof t!="string"?[]:t.split(".")}function F(t,e){const r=ie(t);if(r.length===0||typeof e!="object"||e===null)return;let s=e[r[0]];for(let n=1;n<r.length&&s!=null;n+=1)s=s[r[n]];return s}function N(t,e,r){const s=ie(t);if(s.length===0)return r;const n=A(r);if(s.length===1)return n[s[0]]=e,n;let o=n[s[0]];for(let c=1;c<s.length-1;c+=1){if(o===void 0)return n;o=o[s[c]]}return o[s[s.length-1]]=e,n}function Oe(t,{from:e,to:r},s){const n=F(t,s);if(!Array.isArray(n))return s;const o=[...n],c=n[e];return o.splice(e,1),o.splice(r,0,c),N(t,o,s)}function we(t,e,r,s){const n=F(t,s);if(!Array.isArray(n))return s;const o=[...n];return o.splice(typeof r=="number"?r:o.length,0,e),N(t,o,s)}function $e(t,e,r){const s=F(t,r);return Array.isArray(s)?N(t,s.filter((n,o)=>o!==e),r):r}function Ie(t,e,r,s){const n=F(t,s);if(!Array.isArray(n)||n.length<=r)return s;const o=[...n];return o[r]=e,N(t,o,s)}function Le({$values:t,$errors:e,$status:r}){const s=a.useCallback((i,u)=>{r.clearFieldDirty(i),e.setErrors(f=>De(i,u,f)),t.setValues({values:Oe(i,u,t.refValues.current),updateState:!0})},[]),n=a.useCallback((i,u)=>{r.clearFieldDirty(i),e.setErrors(f=>te(i,u,f,-1)),t.setValues({values:$e(i,u,t.refValues.current),updateState:!0})},[]),o=a.useCallback((i,u,f)=>{r.clearFieldDirty(i),e.setErrors(V=>te(i,f,V,1)),t.setValues({values:we(i,u,f,t.refValues.current),updateState:!0})},[]),c=a.useCallback((i,u,f)=>{r.clearFieldDirty(i),t.setValues({values:Ie(i,f,u,t.refValues.current),updateState:!0})},[]);return{reorderListItem:s,removeListItem:n,insertListItem:o,replaceListItem:c}}var U,se;function Re(){return se||(se=1,U=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var s,n,o;if(Array.isArray(e)){if(s=e.length,s!=r.length)return!1;for(n=s;n--!==0;)if(!t(e[n],r[n]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),s=o.length,s!==Object.keys(r).length)return!1;for(n=s;n--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[n]))return!1;for(n=s;n--!==0;){var c=o[n];if(!t(e[c],r[c]))return!1}return!0}return e!==e&&r!==r}),U}var Te=Re();const W=Fe(Te);function q(t,e){const r=Object.keys(t);if(typeof e=="string"){const s=r.filter(n=>n.startsWith(`${e}.`));return t[e]||s.some(n=>t[n])||!1}return r.some(s=>t[s])}function Ae({initialDirty:t,initialTouched:e,mode:r,$values:s}){const[n,o]=a.useState(e),[c,i]=a.useState(t),u=a.useRef(e),f=a.useRef(t),V=a.useCallback(b=>{const p=typeof b=="function"?b(u.current):b;u.current=p,r==="controlled"&&o(p)},[]),h=a.useCallback((b,p=!1)=>{const S=typeof b=="function"?b(f.current):b;f.current=S,(r==="controlled"||p)&&i(S)},[]),m=a.useCallback(()=>V({}),[]),T=a.useCallback(b=>{const p=b?{...s.refValues.current,...b}:s.refValues.current;s.setValuesSnapshot(p),h({})},[]),P=a.useCallback((b,p)=>{V(S=>q(S,b)===p?S:{...S,[b]:p})},[]),_=a.useCallback((b,p,S)=>{h(O=>q(O,b)===p?O:{...O,[b]:p},S)},[]),d=a.useCallback((b,p)=>{const S=q(f.current,b),O=!W(F(b,s.getValuesSnapshot()),p),L=Z(b,f.current);L[b]=O,h(L,S!==O)},[]),y=a.useCallback(b=>q(u.current,b),[]),E=a.useCallback(b=>h(p=>{if(typeof b!="string")return p;const S=Z(b,p);return delete S[b],W(S,p)?p:S}),[]),D=a.useCallback(b=>{if(b){const S=F(b,f.current);if(typeof S=="boolean")return S;const O=F(b,s.refValues.current),L=F(b,s.valuesSnapshot.current);return!W(O,L)}return Object.keys(f.current).length>0?q(f.current):!W(s.refValues.current,s.valuesSnapshot.current)},[]),C=a.useCallback(()=>f.current,[]),I=a.useCallback(()=>u.current,[]);return{touchedState:n,dirtyState:c,touchedRef:u,dirtyRef:f,setTouched:V,setDirty:h,resetDirty:T,resetTouched:m,isTouched:y,setFieldTouched:P,setFieldDirty:_,setTouchedState:o,setDirtyState:i,clearFieldDirty:E,isDirty:D,getDirty:C,getTouched:I,setCalculatedFieldDirty:d}}function Pe({initialValues:t,onValuesChange:e,mode:r}){const s=a.useRef(!1),[n,o]=a.useState(t||{}),c=a.useRef(n),i=a.useRef(n),u=a.useCallback(({values:d,subscribers:y,updateState:E=!0,mergeWithPreviousValues:D=!0})=>{const C=c.current,I=d instanceof Function?d(c.current):d,b=D?{...C,...I}:I;c.current=b,E&&(o(b),r==="uncontrolled"&&(c.current=b)),e?.(b,C),y?.filter(Boolean).forEach(p=>p({updatedValues:b,previousValues:C}))},[e]),f=a.useCallback(d=>{const y=F(d.path,c.current),E=d.value instanceof Function?d.value(y):d.value;if(y!==E){const D=c.current,C=N(d.path,E,c.current);u({values:C,updateState:d.updateState}),d.subscribers?.filter(Boolean).forEach(I=>I({path:d.path,updatedValues:C,previousValues:D}))}},[u]),V=a.useCallback(d=>{i.current=d},[]),h=a.useCallback((d,y)=>{s.current||(s.current=!0,u({values:d,updateState:r==="controlled"}),V(d),y())},[u]),m=a.useCallback(()=>{u({values:i.current,updateState:!0,mergeWithPreviousValues:!1})},[u]),T=a.useCallback(()=>c.current,[]),P=a.useCallback(()=>i.current,[]),_=a.useCallback((d,y)=>{const E=F(d,i.current);typeof E>"u"||f({path:d,value:E,updateState:r==="controlled",subscribers:y})},[f,r]);return{initialized:s,stateValues:n,refValues:c,valuesSnapshot:i,setValues:u,setFieldValue:f,resetValues:m,setValuesSnapshot:V,initialize:h,getValues:T,getValuesSnapshot:P,resetField:_}}function _e({$status:t,cascadeUpdates:e}){const r=a.useRef({}),s=a.useCallback((o,c)=>{a.useEffect(()=>(r.current[o]=r.current[o]||[],r.current[o].push(c),()=>{r.current[o]=r.current[o].filter(i=>i!==c)}),[c])},[]),n=a.useCallback(o=>{const c=r.current[o]?.map(i=>u=>i({previousValue:F(o,u.previousValues),value:F(o,u.updatedValues),touched:t.isTouched(o),dirty:t.isDirty(o)}))??[];if(e)for(const i in r.current)(i.startsWith(`${o}.`)||o.startsWith(`${i}.`))&&c.push(...r.current[i].map(u=>f=>u({previousValue:F(i,f.previousValues),value:F(i,f.updatedValues),touched:t.isTouched(i),dirty:t.isDirty(i)})));return c},[]);return{subscribers:r,watch:s,getFieldSubscribers:n}}function ne(t,e){return t?`${t}-${e.toString()}`:e.toString()}const z=Symbol("root-rule");function oe(t){const e=X(t);return{hasErrors:Object.keys(e).length>0,errors:e}}function G(t,e,r="",s={}){return typeof t!="object"||t===null?s:Object.keys(t).reduce((n,o)=>{const c=t[o],i=`${r===""?"":`${r}.`}${o}`,u=F(i,e);let f=!1;return typeof c=="function"&&(n[i]=c(u,e,i)),typeof c=="object"&&Array.isArray(u)&&(f=!0,u.forEach((V,h)=>G(c,e,`${i}.${h}`,n)),z in c&&(n[i]=c[z](u,e,i))),typeof c=="object"&&typeof u=="object"&&u!==null&&(f||G(c,e,i,n),z in c&&(n[i]=c[z](u,e,i))),n},s)}function J(t,e){return oe(typeof t=="function"?t(e):G(t,e))}function B(t,e,r){if(typeof t!="string")return{hasError:!1,error:null};const s=J(e,r),n=Object.keys(s.errors).find(o=>t.split(".").every((c,i)=>c===o.split(".")[i]));return{hasError:!!n,error:n?s.errors[n]:null}}const ve="__MANTINE_FORM_INDEX__";function ce(t,e){return e?typeof e=="boolean"?e:Array.isArray(e)?e.includes(t.replace(/[.][0-9]+/g,`.${ve}`)):!1:!1}function Ne({name:t,mode:e="controlled",initialValues:r,initialErrors:s={},initialDirty:n={},initialTouched:o={},clearInputErrorOnChange:c=!0,validateInputOnChange:i=!1,validateInputOnBlur:u=!1,onValuesChange:f,transformValues:V=(d=>d),enhanceGetInputProps:h,validate:m,onSubmitPreventDefault:T="always",touchTrigger:P="change",cascadeUpdates:_=!1}={}){const d=ke(s),y=Pe({initialValues:r,onValuesChange:f,mode:e}),E=Ae({initialDirty:n,initialTouched:o,$values:y,mode:e}),D=Le({$values:y,$errors:d,$status:E}),C=_e({$status:E,cascadeUpdates:_}),[I,b]=a.useState(0),[p,S]=a.useState({}),[O,L]=a.useState(!1),Q=a.useCallback(()=>{y.resetValues(),d.clearErrors(),E.resetDirty(),E.resetTouched(),e==="uncontrolled"&&b(l=>l+1)},[]),K=a.useCallback(l=>{c&&d.clearErrors(),e==="uncontrolled"&&b(g=>g+1),Object.keys(C.subscribers.current).forEach(g=>{const k=F(g,y.refValues.current),w=F(g,l);k!==w&&C.getFieldSubscribers(g).forEach(R=>R({previousValues:l,updatedValues:y.refValues.current}))})},[c]),le=a.useCallback(l=>{const g=y.refValues.current;y.initialize(l,()=>e==="uncontrolled"&&b(k=>k+1)),K(g)},[K]),Y=a.useCallback((l,g,k)=>{const w=ce(l,i),R=g instanceof Function?g(F(l,y.refValues.current)):g;E.setCalculatedFieldDirty(l,R),P==="change"&&E.setFieldTouched(l,!0),!w&&c&&d.clearFieldError(l),y.setFieldValue({path:l,value:g,updateState:e==="controlled",subscribers:[...C.getFieldSubscribers(l),w?v=>{const $=B(l,m,v.updatedValues);$.hasError?d.setFieldError(l,$.error):d.clearFieldError(l)}:null,k?.forceUpdate!==!1&&e!=="controlled"?()=>S(v=>({...v,[l]:(v[l]||0)+1})):null]})},[f,m]),ae=a.useCallback(l=>{const g=y.refValues.current;y.setValues({values:l,updateState:e==="controlled"}),K(g)},[f,K]),x=a.useCallback(()=>{const l=J(m,y.refValues.current);return d.setErrors(l.errors),l},[m]),fe=a.useCallback(l=>{const g=B(l,m,y.refValues.current);return g.hasError?d.setFieldError(l,g.error):d.clearFieldError(l),g},[m]),de=(l,{type:g="input",withError:k=!0,withFocus:w=!0,...R}={})=>{const $={onChange:Ce(M=>Y(l,M,{forceUpdate:!1})),"data-path":ne(t,l)};return k&&($.error=d.errorsState[l]),g==="checkbox"?$[e==="controlled"?"checked":"defaultChecked"]=F(l,y.refValues.current):$[e==="controlled"?"value":"defaultValue"]=F(l,y.refValues.current),w&&($.onFocus=()=>E.setFieldTouched(l,!0),$.onBlur=()=>{if(ce(l,u)){const M=B(l,m,y.refValues.current);M.hasError?d.setFieldError(l,M.error):d.clearFieldError(l)}}),Object.assign($,h?.({inputProps:$,field:l,options:{type:g,withError:k,withFocus:w,...R},form:H}))},be=(l,g)=>k=>{T==="always"&&k?.preventDefault();const w=x();if(w.hasErrors)T==="validation-failed"&&k?.preventDefault(),g?.(w.errors,y.refValues.current,k);else{const R=l?.(V(y.refValues.current),k);R instanceof Promise&&(L(!0),R.finally(()=>L(!1)))}},ye=l=>V(l||y.refValues.current),Ve=a.useCallback(l=>{l.preventDefault(),Q()},[]),ge=a.useCallback(l=>l?!B(l,m,y.refValues.current).hasError:!J(m,y.refValues.current).hasErrors,[m]),Ee=l=>`${I}-${String(l)}-${p[String(l)]||0}`,pe=a.useCallback(l=>document.querySelector(`[data-path="${ne(t,l)}"]`),[]),Se=a.useCallback(l=>{y.resetField(l,[e!=="controlled"?()=>S(g=>({...g,[l]:(g[l]||0)+1})):null])},[y.resetField,e,S]),H={watch:C.watch,initialized:y.initialized.current,values:e==="uncontrolled"?y.refValues.current:y.stateValues,getValues:y.getValues,getInitialValues:y.getValuesSnapshot,setInitialValues:y.setValuesSnapshot,resetField:Se,initialize:le,setValues:ae,setFieldValue:Y,submitting:O,setSubmitting:L,errors:d.errorsState,setErrors:d.setErrors,setFieldError:d.setFieldError,clearFieldError:d.clearFieldError,clearErrors:d.clearErrors,resetDirty:E.resetDirty,setTouched:E.setTouched,setDirty:E.setDirty,isTouched:E.isTouched,resetTouched:E.resetTouched,isDirty:E.isDirty,getTouched:E.getTouched,getDirty:E.getDirty,reorderListItem:D.reorderListItem,insertListItem:D.insertListItem,removeListItem:D.removeListItem,replaceListItem:D.replaceListItem,reset:Q,validate:x,validateField:fe,getInputProps:de,onSubmit:be,onReset:Ve,isValid:ge,getTransformedValues:ye,key:Ee,getInputNode:pe};return je(t,H),H}function ue(t,e){if(typeof t=="number")return e.length===t;const{max:r,min:s}=t;let n=!0;return typeof r=="number"&&e.length>r&&(n=!1),typeof s=="number"&&e.length<s&&(n=!1),n}function Ke(t,e){const r=e||!0;return s=>typeof s=="string"?ue(t,s.trim())?null:r:typeof s=="object"&&s!==null&&"length"in s&&ue(t,s)?null:r}export{Ke as h,Ne as u};
